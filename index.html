<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <!-- CHANGE 1: Correct viewport for responsive design -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>fullofcoins</title>
    <link rel="icon" href="favicon.png" type="image/png" />
</head>
<body>
    <div class="layout-wrapper">
        <!-- CHANGE 2: Added id="sidebar" for easier JS targeting -->
        <div class="sidebar" id="sidebar">
            <h2>fullofcoins</h2>
            <ul>
                <li>üè† Home</li>
                <li>üßæ Explore</li>
                <li>üë§ Profile</li>
                <li><button id="connectBtn">Connect Wallet</button></li>
            </ul>
            <div id="walletAddress" class="wallet-address"></div>
        </div>

        <!-- CHANGE 3: New overlay to dim background when menu is open -->
        <div class="sidebar-overlay" id="sidebar-overlay"></div>

        <!-- Tweet Feed -->
        <div class="main-feed">
            <!-- CHANGE 4: New wrapper for header to align button and title -->
            <div class="feed-header">
                <!-- CHANGE 5: New "hamburger" menu button -->
                <button id="menu-toggle-btn" class="menu-toggle">‚ò∞</button>
                <h2>Decentralized Tweets</h2>
            </div>
            <div id="tweetList">
                <!-- Tweets will go here -->
            </div>
        </div>

        <!-- Right Panel -->
        <div class="right-panel">
            <h3>Coming Soon</h3>
            <p>Analytics, Suggestions, or Ads</p>
        </div>
    </div>

    <!-- Wallet Modal   -->
    <div id="walletModal" class="modal">
        <div class="modal-content">
            <h3>Connect Wallet</h3>
            <button id="metamaskBtn">ü¶ä Connect with MetaMask</button>
            <button id="closeModal" class="close-btn">Cancel</button>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"></div>

    <!-- Scripts -->
    <script src="https://unpkg.com/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <script>
    // --- The Final Initialization ---
    const version = Date.now();
    const link = document.createElement('link');
    link.rel = 'stylesheet';
    link.href = `style.css?v=${version}`;
    document.head.appendChild(link);
    const script1 = document.createElement('script');
    script1.src = `app.js?v=${version}`;
    document.body.appendChild(script1);
    const script2 = document.createElement('script');
    script2.src = `tweetFetcher.js?v=${version}`;
    document.body.appendChild(script2);

    const chains = [
        {
            rpcUrl: 'https://ethereum-sepolia.publicnode.com',
            contractAddress: '0xF9cF9c918b4DD16e5906FF70Ba58228E3d784736',
            startBlock: 8594107,
            chainId: 11155111,
        },
    ];

    window.addEventListener('DOMContentLoaded', () => {
        const ready = setInterval(() => {
            if (window.tweetFetcher && window.ethers) {
                clearInterval(ready);
                
                // --- CHANGE 6: ADDED NEW MENU JAVASCRIPT ---
                const menuToggleBtn = document.getElementById('menu-toggle-btn');
                const sidebar = document.getElementById('sidebar');
                const overlay = document.getElementById('sidebar-overlay');

                function closeMenu() {
                    sidebar.classList.remove('is-open');
                    document.body.classList.remove('menu-is-open');
                }

                function openMenu() {
                    sidebar.classList.add('is-open');
                    document.body.classList.add('menu-is-open');
                }
                
                menuToggleBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (sidebar.classList.contains('is-open')) {
                        closeMenu();
                    } else {
                        openMenu();
                    }
                });

                overlay.addEventListener('click', closeMenu);
                // --- END OF NEW MENU JAVASCRIPT ---
                
                tweetFetcher.init();
                tweetFetcher.loadCachedTweets();
                tweetFetcher.fetchAndUpdateTweets(chains);
                setInterval(() => tweetFetcher.fetchAndUpdateTweets(chains), 60000);
            }
        }, 100);
    });
</script>
</body>
</html>